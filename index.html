<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>祈愿系统</title>
    <link rel="stylesheet" href="./css/index.css">
</head>
<style>

</style>

<body>
    <div id="app">

        <div class="mainBox">
            <div class="header">
                <div class="header-left">
                    <div class="star"></div>
                    <span>{{ t('title') }}</span>
                </div>
                <div class="header-center">

                </div>
                <div class="header-right">
                    <div class="yuanshi">
                        <div class="yuanshi-left"></div>
                        <span class="yuanshi-num">3312</span>
                        <div class="yuanshi-add"></div>
                    </div>

                    <div class="jiuchan">
                        <div class="jiuchan-left"></div>
                        <span class="jiuchan-num">443</span>
                    </div>

                    <div class="close">
                        <div class="close-box"></div>
                    </div>
                </div>
            </div>
            <div class="center">
                <div class="center-left"></div>
                <div class="center-center"></div>
                <div class="center-right"></div>
            </div>
            <div class="footer">
                <div class="footer-left">
                    <div class="footer-left-top">
                        <div class="XHBox">
                            <div class="XHBoxSR">
                                <div class="xinghuiSR"></div>
                                <span>114</span>
                            </div>
                            <div class="XHBoxR">
                                <div class="xinghuiR"></div>
                                <span>3313</span>
                            </div>
                        </div>
                    </div>
                    <div class="footer-left-bottom">
                        <div class="history" @click="toggleHistory">
                            {{ t('history') }}
                        </div>
                    </div>
                </div>
                <div class="footer-right">
                    <!-- 按钮容器 - 横向排列 -->
                    <div class="buttons-container">
                        <div class="chou" @click="handleDrew">
                            {{ t('singleDraw') }}
                        </div>
                        <div class="chou ten-draw" @click="handleTenDrew">
                            {{ t('tenDraw') }}
                        </div>
                    </div>
                    <!-- 跳过动画选项 -->
                    <div class="skip-animation-toggle">
                        <input type="checkbox" id="skip-animation" v-model="skipAnimation">
                        <label for="skip-animation">{{ t('skipAnimation') }}</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="MyVideo" v-show="isShow">
            <video @ended="VideoEnd" src="./util/video/star.mp4" width="100%" ref="myVideo"> </video>
        </div>

        <!-- 祈愿结果显示界面 -->
        <div class="result-container" v-show="studentsBoxShow">
            <!-- 闪光效果 -->
            <div class="result-flash" :key="flashKey"></div>
            <!-- 关闭按钮 -->
            <div class="result-close" @click="toInit">
                <div class="close-icon"></div>
            </div>
            
            <!-- 结果标题 -->
            <div class="result-header">
                <h2 class="result-title">{{isTenDraw ? t('tenResultTitle') : t('resultTitle')}}</h2>
            </div>
            
            <!-- 主要结果展示区 - 包含幸运儿和十连抽结果 -->
            <div class="result-main">
                <!-- 左侧：幸运儿窗口 -->
                <div class="result-card">
                    <div class="result-animation">
                        <div class="result-glow"></div>
                        <h1 :class="nameClass" v-show="nameShow" class="result-name">{{thisName}}</h1>
                    </div>
                    <div class="result-info">
                        <div class="result-type">{{ t('luckyOne') }}</div>
                        <div class="result-timestamp">{{currentTime}}</div>
                    </div>
                    
                    <!-- 十连抽进度指示器 -->
                    <div v-if="isTenDraw" class="ten-draw-progress">
                        <div class="progress-text">
                            {{ t('currentDraw').replace('{index}', tenDrawIndex) }}
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" :style="{width: (tenDrawIndex * 10) + '%'}"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 右侧：十连抽结果列表 -->
                <div class="ten-draw-results" v-if="isTenDraw && showTenDrawResult">
                    <h3 class="ten-draw-title">{{ t('thisTenResult') }}</h3>
                    <div class="ten-draw-list">
                        <div v-for="(name, index) in tenDrawResults" :key="index" class="ten-draw-item">
                            <div class="item-index">{{index + 1}}</div>
                            <div class="item-name">{{name}}</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 操作按钮区 -->
            <div class="result-actions">
                <!-- 十连抽专用按钮 -->
                <button v-if="isTenDraw && tenDrawIndex < 10" class="action-btn next-btn" @click="showNextTenDrawResult">
                    <div class="btn-icon next-icon"></div>
                    <span>{{ t('nextOne') }}</span>
                </button>
                
                <!-- 查看全部十连抽结果按钮 -->
                <button v-if="isTenDraw" class="action-btn view-all-btn" @click="showTenDrawResult = !showTenDrawResult">
                    <div class="btn-icon view-all-icon"></div>
                    <span>{{showTenDrawResult ? t('hideAll') : t('viewAll')}}</span>
                </button>
                
                <!-- 通用按钮 -->
                <button class="action-btn share-btn" @click="shareResult">
                    <div class="btn-icon share-icon"></div>
                    <span>{{ t('shareResult') }}</span>
                </button>
                <button class="action-btn history-btn" @click="toggleHistory">
                    <div class="btn-icon history-icon"></div>
                    <span>{{ t('history') }}</span>
                </button>
                <button class="action-btn stats-btn" @click="toggleStats">
                    <div class="btn-icon stats-icon"></div>
                    <span>{{ t('prayStats') }}</span>
                </button>
                <button class="action-btn draw-again-btn" @click="drawAgain">
                    <div class="btn-icon draw-icon"></div>
                    <span>{{ t('prayAgain') }}</span>
                </button>
            </div>
            
        </div>
        <!-- 祈愿统计面板 -->
        <div class="stats-panel" :class="{active: showStats}">
            <div class="stats-header">
                <h3>{{ t('prayStats') }}</h3>
                <div class="stats-close">
                    <div class="close-icon" @click="toggleStats"></div>
                </div>
            </div>
            <div class="stats-content">
                <div v-if="historyList.length === 0" class="no-stats">
                    <p>{{ t('noStats') }}</p>
                </div>
                <div v-else class="stats-main">
                    <!-- 总祈愿次数 -->
                    <div class="stats-item">
                        <div class="stats-label">{{ t('totalPrays') }}</div>
                        <div class="stats-value">{{historyList.length}}</div>
                    </div>
                    
                    <!-- 抽中次数最多的人 -->
                    <div class="stats-item">
                        <div class="stats-label">{{ t('luckyKing') }}</div>
                        <div class="stats-value stats-lucky">{{topStudent.name}}</div>
                    </div>
                    
                    <!-- 抽中次数 -->
                    <div class="stats-item">
                        <div class="stats-label">{{ t('prayCount') }}</div>
                        <div class="stats-value">{{topStudent.count}}次</div>
                    </div>
                    
                    <!-- 详细统计列表 -->
                    <div class="stats-list">
                        <h4>{{ t('detailedStats') }}</h4>
                        <div v-for="(item, index) in statsList" :key="index" class="stats-list-item">
                            <div class="stats-list-name">{{item.name}}</div>
                            <div class="stats-list-count">
                                <div class="stats-bar-container">
                                    <div class="stats-bar" :style="{width: item.percentage + '%'}"></div>
                                </div>
                                <div class="stats-list-number">{{item.count}}次</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 历史记录面板 - 移到result-container之外，使其可以独立显示 -->
        <div class="history-panel" :class="{active: showHistory}">
            <div class="history-header">
                <h3>{{ t('historyResults') }}</h3>
                <div class="history-actions">
                    <button class="history-btn clear-btn" @click="clearHistory">
                        <span>{{ t('clearHistory') }}</span>
                    </button>
                    <div class="history-close">
                        <div class="close-icon" @click="toggleHistory"></div>
                    </div>
                </div>
            </div>
            <div class="history-list">
                <div v-if="historyList.length === 0" class="no-history">
                    <p>{{ t('noHistory') }}</p>
                </div>
                <div v-for="(item, index) in historyList" :key="index" class="history-item">
                    <div class="history-content">
                        <div class="history-name">{{item.name}}</div>
                        <div class="history-time">{{item.time}}</div>
                    </div>
                    <div class="history-index">{{index + 1}}</div>
                </div>
            </div>
        </div>
        
        <!-- 设置面板 -->
        <div class="settings-panel" :class="{active: showSettings}">
            <div class="settings-header">
                <h3>{{ t('settings') }}</h3>
                <div class="settings-close">
                    <div class="close-icon" @click="toggleSettings"></div>
                </div>
            </div>
            <div class="settings-content">
                <!-- 语言设置 -->
                <div class="settings-section">
                    <h4>{{ t('languageSetting') }}</h4>
                    <div class="language-select">
                        <select v-model="currentLanguage" @change="changeLanguage">
                            <option value="zh">中文</option>
                            <option value="wenyan">文言文</option>
                            <option value="en">English</option>
                            <option value="fr">Français</option>
                            <option value="ru">Русский</option>
                        </select>
                    </div>
                </div>
                
                <!-- 动画设置 -->
                <div class="settings-section">
                    <h4>{{ t('animationSetting') }}</h4>
                    <div class="setting-item">
                        <label for="skip-animation-setting">{{ t('skipAnimation') }}</label>
                        <input type="checkbox" id="skip-animation-setting" v-model="skipAnimation">
                    </div>
                </div>
                
                <!-- 音效设置 -->
                <div class="settings-section">
                    <h4>{{ t('soundSetting') }}</h4>
                    <div class="setting-item">
                        <label for="sound-effect">{{ t('soundEnabled') }}</label>
                        <input type="checkbox" id="sound-effect" v-model="soundEnabled">
                    </div>
                </div>
                
                <!-- Cookie设置 -->
                <div class="settings-section">
                    <h4>Cookie设置</h4>
                    <div class="setting-item">
                        <button class="action-btn clear-btn" @click="clearCookies" style="margin: 0 auto;">
                            清除Cookie
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 设置按钮 -->
        <div class="settings-btn" @click="toggleSettings">
            <div class="settings-icon"></div>
        </div>
    </div>
    
    <script src="./util/vue.global.js"></script>
    <script src="./js/config.js"></script>
    <script src="./js/i18n.js"></script>
    <script src="./js/app.js"></script>
</body>

</html>